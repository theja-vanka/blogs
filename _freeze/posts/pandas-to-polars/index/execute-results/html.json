{
  "hash": "0d71feb9850bb180f111a862be5a7466",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"From Pandas to Polars\"\nauthor: \"Krishnatheja Vanka\"\ndate: \"2025-05-19\"\ncategories: [code, tutorial]\nformat:\n  html:\n    code-fold: false\nexecute:\n  echo: true\n  timing: true\njupyter: python3\n---\n\n# üêº From Pandas to Polars üêª‚Äç‚ùÑÔ∏è\n\n![](pvp.jpg)\n\nAs datasets grow in size and complexity, performance and efficiency become critical in data processing. While Pandas has long been the go-to library for data manipulation in Python, it can struggle with speed and memory usage, especially on large datasets. Polars, a newer DataFrame library written in Rust, offers a faster, more memory-efficient alternative with support for lazy evaluation and multi-threading.\n\nThis guide explores how to convert Pandas DataFrames to Polars, and highlights key differences in syntax, performance, and functionality. Whether you're looking to speed up your data workflows or just exploring modern tools, understanding the transition from Pandas to Polars is a valuable step.\n\n## 1. Import libraries\n\n::: {#e40a0452 .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\n\nimport pandas as pd\nimport polars as pl\n```\n:::\n\n\n## 2. Create dummy data\n\n::: {#35ed15de .cell execution_count=2}\n``` {.python .cell-code}\ndata = {\n  'birds': ['Cranes', 'Cranes', 'plovers', 'spoonbills', 'spoonbills', 'Cranes', 'plovers', 'Cranes', 'spoonbills', 'spoonbills'],\n  'age': [3.5, 4, 1.5, np.nan, 6, 3, 5.5, np.nan, 8, 4],\n  'visits': [2, 4, 3, 4, 3, 4, 2, 2, 3, 2],\n  'priority': ['yes', 'yes', 'no', 'yes', 'no', 'no', 'no', 'yes', 'no', 'no']\n}\n\nlabels = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j']\n```\n:::\n\n\n## 3. Create Pandas DataFrame\n\n::: {#1a6051b7 .cell execution_count=3}\n``` {.python .cell-code}\npandas_df = pd.DataFrame(data, index=labels)\npandas_df\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>b</th>\n      <td>Cranes</td>\n      <td>4.0</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>c</th>\n      <td>plovers</td>\n      <td>1.5</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>d</th>\n      <td>spoonbills</td>\n      <td>NaN</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>e</th>\n      <td>spoonbills</td>\n      <td>6.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>f</th>\n      <td>Cranes</td>\n      <td>3.0</td>\n      <td>4</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>g</th>\n      <td>plovers</td>\n      <td>5.5</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>i</th>\n      <td>spoonbills</td>\n      <td>8.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>j</th>\n      <td>spoonbills</td>\n      <td>4.0</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## 4. Create Polars DataFrame\n\n::: {#6480fdf7 .cell execution_count=4}\n``` {.python .cell-code}\npolars_df = pl.DataFrame(data)\npolars_df = polars_df.with_columns(pl.Series(name='index', values=labels))\npolars_df\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>3.5</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>4.0</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;b&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>1.5</td><td>3</td><td>&quot;no&quot;</td><td>&quot;c&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>NaN</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;d&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>6.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;e&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>3.0</td><td>4</td><td>&quot;no&quot;</td><td>&quot;f&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>5.5</td><td>2</td><td>&quot;no&quot;</td><td>&quot;g&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>NaN</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;h&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>8.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;i&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>4.0</td><td>2</td><td>&quot;no&quot;</td><td>&quot;j&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 5. Display a summary of the basic information about birds DataFrame and its data. \nThe method `describe()` shows different statistical data for numeric columns (like age) and columns with strings or timestamps (like priority, which is treated as a string column in pandas).\nIt is the same for both pandas and polars.\n\n::: {#c14ca04f .cell execution_count=5}\n``` {.python .cell-code}\npandas_df.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>age</th>\n      <th>visits</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>8.000000</td>\n      <td>10.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>4.437500</td>\n      <td>2.900000</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>2.007797</td>\n      <td>0.875595</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1.500000</td>\n      <td>2.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>3.375000</td>\n      <td>2.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>4.000000</td>\n      <td>3.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>5.625000</td>\n      <td>3.750000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>8.000000</td>\n      <td>4.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#30e51618 .cell execution_count=6}\n``` {.python .cell-code}\npolars_df.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (9, 6)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>statistic</th><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;count&quot;</td><td>&quot;10&quot;</td><td>10.0</td><td>10.0</td><td>&quot;10&quot;</td><td>&quot;10&quot;</td></tr><tr><td>&quot;null_count&quot;</td><td>&quot;0&quot;</td><td>0.0</td><td>0.0</td><td>&quot;0&quot;</td><td>&quot;0&quot;</td></tr><tr><td>&quot;mean&quot;</td><td>null</td><td>NaN</td><td>2.9</td><td>null</td><td>null</td></tr><tr><td>&quot;std&quot;</td><td>null</td><td>NaN</td><td>0.875595</td><td>null</td><td>null</td></tr><tr><td>&quot;min&quot;</td><td>&quot;Cranes&quot;</td><td>1.5</td><td>2.0</td><td>&quot;no&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;25%&quot;</td><td>null</td><td>3.5</td><td>2.0</td><td>null</td><td>null</td></tr><tr><td>&quot;50%&quot;</td><td>null</td><td>5.5</td><td>3.0</td><td>null</td><td>null</td></tr><tr><td>&quot;75%&quot;</td><td>null</td><td>8.0</td><td>4.0</td><td>null</td><td>null</td></tr><tr><td>&quot;max&quot;</td><td>&quot;spoonbills&quot;</td><td>8.0</td><td>4.0</td><td>&quot;yes&quot;</td><td>&quot;j&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 6. Print the first 2 rows of the birds dataframe\nThe method `head()` displays the first 5 rows of the DataFrame. It is the same for both pandas and polars. Including a number in the method `head()` will display the first n rows of the DataFrame.\n\n::: {#48295054 .cell execution_count=7}\n``` {.python .cell-code}\npandas_df.head(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>b</th>\n      <td>Cranes</td>\n      <td>4.0</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#8bf13965 .cell execution_count=8}\n``` {.python .cell-code}\npolars_df.head(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (2, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>3.5</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>4.0</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;b&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 7. Display the last 3 rows of the birds dataframe\nThe method `tail()` displays the last 5 rows of the DataFrame. It is the same for both pandas and polars. Including a number in the method `tail()` will display the last n rows of the DataFrame.\n\n::: {#34e6c566 .cell execution_count=9}\n``` {.python .cell-code}\npandas_df.tail(3)\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>i</th>\n      <td>spoonbills</td>\n      <td>8.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>j</th>\n      <td>spoonbills</td>\n      <td>4.0</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#403a4678 .cell execution_count=10}\n``` {.python .cell-code}\npolars_df.tail(3)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>NaN</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;h&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>8.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;i&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>4.0</td><td>2</td><td>&quot;no&quot;</td><td>&quot;j&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 8. Select only the 'birds' and 'age' columns from the DataFrame.\nIn pandas, you can use the `[]` operator to select columns by name. In polars, you can use the `select()` method to select columns by name.\n\n::: {#33ae5afa .cell execution_count=11}\n``` {.python .cell-code}\npandas_df[['birds', 'age']] \n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>b</th>\n      <td>Cranes</td>\n      <td>4.0</td>\n    </tr>\n    <tr>\n      <th>c</th>\n      <td>plovers</td>\n      <td>1.5</td>\n    </tr>\n    <tr>\n      <th>d</th>\n      <td>spoonbills</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>e</th>\n      <td>spoonbills</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>f</th>\n      <td>Cranes</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>g</th>\n      <td>plovers</td>\n      <td>5.5</td>\n    </tr>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>i</th>\n      <td>spoonbills</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>j</th>\n      <td>spoonbills</td>\n      <td>4.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#3fd53a58 .cell execution_count=12}\n``` {.python .cell-code}\npolars_df.select(['index', 'birds', 'age'])\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>index</th><th>birds</th><th>age</th></tr><tr><td>str</td><td>str</td><td>f64</td></tr></thead><tbody><tr><td>&quot;a&quot;</td><td>&quot;Cranes&quot;</td><td>3.5</td></tr><tr><td>&quot;b&quot;</td><td>&quot;Cranes&quot;</td><td>4.0</td></tr><tr><td>&quot;c&quot;</td><td>&quot;plovers&quot;</td><td>1.5</td></tr><tr><td>&quot;d&quot;</td><td>&quot;spoonbills&quot;</td><td>NaN</td></tr><tr><td>&quot;e&quot;</td><td>&quot;spoonbills&quot;</td><td>6.0</td></tr><tr><td>&quot;f&quot;</td><td>&quot;Cranes&quot;</td><td>3.0</td></tr><tr><td>&quot;g&quot;</td><td>&quot;plovers&quot;</td><td>5.5</td></tr><tr><td>&quot;h&quot;</td><td>&quot;Cranes&quot;</td><td>NaN</td></tr><tr><td>&quot;i&quot;</td><td>&quot;spoonbills&quot;</td><td>8.0</td></tr><tr><td>&quot;j&quot;</td><td>&quot;spoonbills&quot;</td><td>4.0</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 9. Select [2, 3, 7] rows and in columns ['birds', 'age', 'visits']\nIn pandas, you can use the `iloc` method to select rows and columns by index. In polars, you can use the `[]` operator to select rows and columns by index.\nThe following code selects rows 2, 3, and 7 and columns 'birds', 'age', and 'visits' from the polars DataFrame. The output shows the values in those cells.\n\n::: {#8749cf9e .cell execution_count=13}\n``` {.python .cell-code}\npandas_df[['birds','age','visits']].iloc[[2,3,7]]\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>c</th>\n      <td>plovers</td>\n      <td>1.5</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>d</th>\n      <td>spoonbills</td>\n      <td>NaN</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>NaN</td>\n      <td>2</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#19693d70 .cell execution_count=14}\n``` {.python .cell-code}\npolars_df[[2,3,7]].select([\"index\", \"birds\", \"age\", \"visits\"])\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 4)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>index</th><th>birds</th><th>age</th><th>visits</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>i64</td></tr></thead><tbody><tr><td>&quot;c&quot;</td><td>&quot;plovers&quot;</td><td>1.5</td><td>3</td></tr><tr><td>&quot;d&quot;</td><td>&quot;spoonbills&quot;</td><td>NaN</td><td>4</td></tr><tr><td>&quot;h&quot;</td><td>&quot;Cranes&quot;</td><td>NaN</td><td>2</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 10. Select the rows where the number of visits is less than 4\nIn pandas, you can use the `loc` method to select rows based on a boolean condition. In polars, you can use the `filter()` method to select rows based on a boolean condition.\n\n::: {#3b303087 .cell execution_count=15}\n``` {.python .cell-code}\npandas_df.loc[pandas_df['visits'] < 4]\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>c</th>\n      <td>plovers</td>\n      <td>1.5</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>e</th>\n      <td>spoonbills</td>\n      <td>6.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>g</th>\n      <td>plovers</td>\n      <td>5.5</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>i</th>\n      <td>spoonbills</td>\n      <td>8.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>j</th>\n      <td>spoonbills</td>\n      <td>4.0</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#1ee65464 .cell execution_count=16}\n``` {.python .cell-code}\npolars_df.filter(pl.col('visits') < 4)\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (7, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>3.5</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>1.5</td><td>3</td><td>&quot;no&quot;</td><td>&quot;c&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>6.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;e&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>5.5</td><td>2</td><td>&quot;no&quot;</td><td>&quot;g&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>NaN</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;h&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>8.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;i&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>4.0</td><td>2</td><td>&quot;no&quot;</td><td>&quot;j&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 11. Select the rows with columns ['birds', 'visits'] where the age is missing i.e NaN\nIn pandas, you can use the `isnull()` method to check for missing values and then use the `loc` method to select rows based on a boolean condition. In polars, you can use the `filter()` method to select rows based on a boolean condition.\n\n::: {#f0c8e303 .cell execution_count=17}\n``` {.python .cell-code}\npandas_df.loc[pandas_df['age'].isnull(), ['birds', 'visits']]\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>visits</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>d</th>\n      <td>spoonbills</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>2</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#2fe7ed12 .cell execution_count=18}\n``` {.python .cell-code}\npolars_df.filter(pl.col('age').is_nan()).select(['index', 'birds', 'visits'])\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (2, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>index</th><th>birds</th><th>visits</th></tr><tr><td>str</td><td>str</td><td>i64</td></tr></thead><tbody><tr><td>&quot;d&quot;</td><td>&quot;spoonbills&quot;</td><td>4</td></tr><tr><td>&quot;h&quot;</td><td>&quot;Cranes&quot;</td><td>2</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 12. Select the rows where the birds is a Cranes and the age is less than 4\n\n::: {#cb3801d2 .cell execution_count=19}\n``` {.python .cell-code}\npandas_df.loc[(pandas_df['birds'] == 'Cranes') & (pandas_df['age'] < 4)]\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>f</th>\n      <td>Cranes</td>\n      <td>3.0</td>\n      <td>4</td>\n      <td>no</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#a8a6fb31 .cell execution_count=20}\n``` {.python .cell-code}\npolars_df.filter((pl.col('birds') == 'Cranes') & (pl.col('age') < 4))\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (2, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>3.5</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>3.0</td><td>4</td><td>&quot;no&quot;</td><td>&quot;f&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 13 .Select the rows the age is between 2 and 4(inclusive)  \n\n::: {#68039b28 .cell execution_count=21}\n``` {.python .cell-code}\npandas_df.loc[pandas_df['age'].between(2, 4)]\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>b</th>\n      <td>Cranes</td>\n      <td>4.0</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>f</th>\n      <td>Cranes</td>\n      <td>3.0</td>\n      <td>4</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>j</th>\n      <td>spoonbills</td>\n      <td>4.0</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#5056aa39 .cell execution_count=22}\n``` {.python .cell-code}\npolars_df.filter(pl.col('age').is_between(2, 4))\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (4, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>3.5</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>4.0</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;b&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>3.0</td><td>4</td><td>&quot;no&quot;</td><td>&quot;f&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>4.0</td><td>2</td><td>&quot;no&quot;</td><td>&quot;j&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 14. Find the total number of visits of the bird Cranes\n\n::: {#dec136a9 .cell execution_count=23}\n``` {.python .cell-code}\npandas_df.loc[pandas_df['birds'] == 'Cranes', 'visits'].sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```\nnp.int64(12)\n```\n:::\n:::\n\n\n::: {#7890c447 .cell execution_count=24}\n``` {.python .cell-code}\npolars_df.filter(pl.col('birds') == 'Cranes').select(pl.col('visits').sum())\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (1, 1)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>visits</th></tr><tr><td>i64</td></tr></thead><tbody><tr><td>12</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 15. Calculate the mean age for each different birds in dataframe.\n\n::: {#41ac68c9 .cell execution_count=25}\n``` {.python .cell-code}\npandas_df.groupby('birds')['age'].mean()\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```\nbirds\nCranes        3.5\nplovers       3.5\nspoonbills    6.0\nName: age, dtype: float64\n```\n:::\n:::\n\n\n::: {#52984126 .cell execution_count=26}\n``` {.python .cell-code}\npolars_df.group_by('birds').agg(pl.col('age').mean())\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th></tr><tr><td>str</td><td>f64</td></tr></thead><tbody><tr><td>&quot;spoonbills&quot;</td><td>NaN</td></tr><tr><td>&quot;Cranes&quot;</td><td>NaN</td></tr><tr><td>&quot;plovers&quot;</td><td>3.5</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 16. Append a new row 'k' to dataframe with your choice of values for each column. Then delete that row to return the original DataFrame.\n### a. Creating new data row\n\n::: {#df2a621a .cell execution_count=27}\n``` {.python .cell-code}\nnew_data = {\n  'birds': 'Cranes',\n  'age': 7.0,\n  'visits': 2,\n  'priority': 'yes'\n}\n```\n:::\n\n\n### b. Append new row to pandas dataframe\n\n::: {#0976dc23 .cell execution_count=28}\n``` {.python .cell-code}\n_df = pd.DataFrame(new_data, index=['k'])\npandas_df = pd.concat([pandas_df, _df])\npandas_df\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>b</th>\n      <td>Cranes</td>\n      <td>4.0</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>c</th>\n      <td>plovers</td>\n      <td>1.5</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>d</th>\n      <td>spoonbills</td>\n      <td>NaN</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>e</th>\n      <td>spoonbills</td>\n      <td>6.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>f</th>\n      <td>Cranes</td>\n      <td>3.0</td>\n      <td>4</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>g</th>\n      <td>plovers</td>\n      <td>5.5</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>i</th>\n      <td>spoonbills</td>\n      <td>8.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>j</th>\n      <td>spoonbills</td>\n      <td>4.0</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>k</th>\n      <td>Cranes</td>\n      <td>7.0</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### c. Delete new row from pandas dataframe\n\n::: {#0416be53 .cell execution_count=29}\n``` {.python .cell-code}\npandas_df = pandas_df.drop('k')\npandas_df\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>b</th>\n      <td>Cranes</td>\n      <td>4.0</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>c</th>\n      <td>plovers</td>\n      <td>1.5</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>d</th>\n      <td>spoonbills</td>\n      <td>NaN</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>e</th>\n      <td>spoonbills</td>\n      <td>6.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>f</th>\n      <td>Cranes</td>\n      <td>3.0</td>\n      <td>4</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>g</th>\n      <td>plovers</td>\n      <td>5.5</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>i</th>\n      <td>spoonbills</td>\n      <td>8.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>j</th>\n      <td>spoonbills</td>\n      <td>4.0</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### d. Append new row to polars dataframe\n\n::: {#c4533ac9 .cell execution_count=30}\n``` {.python .cell-code}\nnew_data['index'] = 'k'\n_df = pl.DataFrame(new_data)\npolars_df = pl.concat([polars_df, _df])\npolars_df\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (11, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>3.5</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>4.0</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;b&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>1.5</td><td>3</td><td>&quot;no&quot;</td><td>&quot;c&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>NaN</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;d&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>6.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;e&quot;</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;plovers&quot;</td><td>5.5</td><td>2</td><td>&quot;no&quot;</td><td>&quot;g&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>NaN</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;h&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>8.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;i&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>4.0</td><td>2</td><td>&quot;no&quot;</td><td>&quot;j&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>7.0</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;k&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### e. Delete new row from polars dataframe\n\n::: {#37452a4a .cell execution_count=31}\n``` {.python .cell-code}\npolars_df = polars_df.filter(pl.col('index') != 'k')\npolars_df\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>3.5</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>4.0</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;b&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>1.5</td><td>3</td><td>&quot;no&quot;</td><td>&quot;c&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>NaN</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;d&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>6.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;e&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>3.0</td><td>4</td><td>&quot;no&quot;</td><td>&quot;f&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>5.5</td><td>2</td><td>&quot;no&quot;</td><td>&quot;g&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>NaN</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;h&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>8.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;i&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>4.0</td><td>2</td><td>&quot;no&quot;</td><td>&quot;j&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 17. Find the number of each type of birds in dataframe (Counts)\n\n::: {#918644f9 .cell execution_count=32}\n``` {.python .cell-code}\npandas_df['birds'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```\nbirds\nCranes        4\nspoonbills    4\nplovers       2\nName: count, dtype: int64\n```\n:::\n:::\n\n\n::: {#10cbc0a7 .cell execution_count=33}\n``` {.python .cell-code}\npolars_df.group_by('birds').len()\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>len</th></tr><tr><td>str</td><td>u32</td></tr></thead><tbody><tr><td>&quot;plovers&quot;</td><td>2</td></tr><tr><td>&quot;spoonbills&quot;</td><td>4</td></tr><tr><td>&quot;Cranes&quot;</td><td>4</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 18. Sort dataframe (birds) first by the values in the 'age' in decending order, then by the value in the 'visits' column in ascending order.\n\n::: {#aa12e456 .cell execution_count=34}\n``` {.python .cell-code}\npandas_df.sort_values(by=['age', 'visits'], ascending=[False, True])\n```\n\n::: {.cell-output .cell-output-display execution_count=34}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>birds</th>\n      <th>age</th>\n      <th>visits</th>\n      <th>priority</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>i</th>\n      <td>spoonbills</td>\n      <td>8.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>e</th>\n      <td>spoonbills</td>\n      <td>6.0</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>g</th>\n      <td>plovers</td>\n      <td>5.5</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>j</th>\n      <td>spoonbills</td>\n      <td>4.0</td>\n      <td>2</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>b</th>\n      <td>Cranes</td>\n      <td>4.0</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>a</th>\n      <td>Cranes</td>\n      <td>3.5</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>f</th>\n      <td>Cranes</td>\n      <td>3.0</td>\n      <td>4</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>c</th>\n      <td>plovers</td>\n      <td>1.5</td>\n      <td>3</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>h</th>\n      <td>Cranes</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>d</th>\n      <td>spoonbills</td>\n      <td>NaN</td>\n      <td>4</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#c29b5107 .cell execution_count=35}\n``` {.python .cell-code}\npolars_df.sort(['age', 'visits'], descending=[True, False])\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>birds</th><th>age</th><th>visits</th><th>priority</th><th>index</th></tr><tr><td>str</td><td>f64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Cranes&quot;</td><td>NaN</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;h&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>NaN</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;d&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>8.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;i&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>6.0</td><td>3</td><td>&quot;no&quot;</td><td>&quot;e&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>5.5</td><td>2</td><td>&quot;no&quot;</td><td>&quot;g&quot;</td></tr><tr><td>&quot;spoonbills&quot;</td><td>4.0</td><td>2</td><td>&quot;no&quot;</td><td>&quot;j&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>4.0</td><td>4</td><td>&quot;yes&quot;</td><td>&quot;b&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>3.5</td><td>2</td><td>&quot;yes&quot;</td><td>&quot;a&quot;</td></tr><tr><td>&quot;Cranes&quot;</td><td>3.0</td><td>4</td><td>&quot;no&quot;</td><td>&quot;f&quot;</td></tr><tr><td>&quot;plovers&quot;</td><td>1.5</td><td>3</td><td>&quot;no&quot;</td><td>&quot;c&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n# References\n```{bibliography}\nhttps://docs.pola.rs/user-guide/getting-started/\nhttps://pandas.pydata.org/docs/getting_started/tutorials.html\n```\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}